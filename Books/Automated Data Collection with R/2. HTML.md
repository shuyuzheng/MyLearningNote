* **H**yper**T**ext **M**arkup **L**anguate, short: HTML, is a language for **presenting content** on Web.
* HTML is basically **plaint text** which is **marked up** by the **tags**.
* We can get the source code of HTML by right-click on the windows and select *view source code*
* **element inspector** can give a hand on checking the matching of the windows elements and source codes.

---

# 1. Syntax rules

## 1.1 Tags, elements and attributes
1. Tags and elements:
    * **element**: The combination of _start tag_, _content_, and _end tag_ is called **element**. (e.g. `<title>First HTML</title>`)
    * **Tags**: _named braces_ that enclose content and define its structural function.(e.g. `<title>`)
    * start tag = opening tag; end tag = closing tag
    * It is recommended that each element has a start and an **paired** end tag, but it is not always true. (e.g. `<br>` tag indicates a _line break_ and is not closed by `</br>`)
    * **empty**: Tags can also close **within the start tag** without any content by adding a slash at the end. (e.g. `<body/>`)
    * HTML is **not** case sensitive. It is nevertheless to always use _small letters** as in `<tagname>`.

2. Attributes
    * **attributes**: attributes enable the specification of options for **how the content of a tag should be handled**.
    * Attributes are always placed within the _start tag_ right after the tag name. (e.g. <`a href="http://www.r-datacollection.com/">Link to Homepage</a>`)
    * Multiple attributes can be separated by _space character_.
    * Attributes are expressed as **name-value pairs**. (`name = 'value'`)

## 1.2 Tree structure
* Basic structure of HTML is **tree structure**
* In HTML file, elements need to be **strictly nested** within each other.

## 1.3 Comments
* **Comments** are the parts of information that are **not displayed** in the broswer.
* Comments are marked by `<!--content of comments-->`.

## 1.4 reserved and special characters
* Reserved characters are used for **control purpose** in a language.
* **character entities (entities)** of HTML (start with `&` and end with `;`, enclosed either by _name_ or _number_). For example:
    
    | Character | Entity number | Entity name | Explanation    |
    | `"`       | &#34;         | &quot;      | quotation mark |
    | `'`       | &#39;         | &apos;      | apostrophe     |
    | `&`       | &#38;         | &amp;       | ampersand      |

## 1.5 Document type definition
* **Document type definition (DTD)**: informs the browser about the **version of HTML standard** the document adheres to. 
* It set in the **first line** of the HTML document with form like `<!DOCTYPE HTML>`.

## 1.6 Spaces and line breaks
* Spaces and line breaks in HTML source code are **not** directly translated in browser windows.
* Non-break spaces: `&nbsp;`
* Line breaks: `<br>`

# 2. Special Tags and Attributes

## 2.1 The anchor tag `<a>`

* The anchor tag `<a>` is what turns HTML from just a markup language into a **hypertext** markup language by enabling HTML documents to **link to** other documents or other part of the same document. (site-to-site navigation)

* link to **other document**:

```
<a href="path_of_linked_file">The words displayed as hyperlink trigger</a>
```

* link to other part of the **current document**
    1. Setting a _reference point_:
    
    ```
    <a id="name_of_reference_point">Reference Point</a>
    ```

    2. Linking to a reference point:

    ```
    <a href="#name_of_reference_point">Words you' like to show on page</a>

* Linking to reference point in another document

```
<a href="path_of_linked_file#name_of_reference_point>Word you'd like to show</a>
```

## 2.2 The metadata tag `<meta>`
* `<meta>` tag provides **meta information** on the HTML document and answer questions like:
    * Who is the author of the document?
    * Which encoding scheme is used?
    * Are there any keywords characterizing the page?
    * What is the language of the document?

* Two attributes for `<meta>` tag
    1. **name** (The information on the documents) or **http-equiv**(How the document needs to be handled by HTTP)
    2. **content**
    3. Example: `<meta name="robots" content="noindex, nogollow">

## 2.3 The external reference tag `<link>`
* The `<link>` tag is used to **link to and include** external information and files. Including:
    * License information for the website.
    * a document listing authors.
    * a help page for the website.
    * an icon that appears in the browser tab.
    * one or more style sheets that are used for layouts.
* The `<link>` tag is **empty** and lays **within the `<head>` element**.
* Example:`<link rel="stylesheet" href="htmlresources/awesomestyle.css" type="text/css"/>

## 2.4 Emphasizing tags `<b>`, `<i>`, `<strong>`
* `<b>`: bold (e.g. `<b>some text set in bold</b>`)
* `<i>`: italics (e.g. `<i>some text set in italics</i>`)
* `<strong>`:strong emphasis (e.g. `<strong>some text so important to be emphasized</strong>`)

## 2.5 The paragraphs tag `<p>`
* The `<p>` tag will insert a line break after the content to make sure they are show in a paragraph.
* Example: `<p>Something in the paragraph</p>`

## 2.6 Heading tags `<h1>`, `<h2>`, `<h3>`...
* There are 6 levels of heading defined by HTML syntax. They are marked by `<h1>, <h2>....<h6>`

## 2.7 Listing content with `<ul>`, `<ol>`, and `<dl>`
* `<ul>`: Unordered list
* `<ol>`: Ordered list
* `<dl>`: A description list

## 2.8 The organizational tags `<div>` and `<span>`
* They are used to **group parts** of the document and don't change the appearance of the content they enclose.
* `<div>`: define groups across lines, tags, and paragraphs.
* `<span>`: is used for **in-line** grouping.
* _class_ attribute: classify the groups to use the same setting in the CSS file.

* They are always combined with **Cascading Style Sheet (CSS)** usually stored in separate CSS files. It's advantages are:
    * separate content from layout to improve the document's **accessibility**.
    * _class_ attribute enables the web designer to **reuse** styles across elements and documents.
    * enables the web designer to change a style in **one** single place with **no effect** on all elements and documents.

## 2.9 The <form> tag and its companions
* HTML forms enable users to interact with servers by **sending data** to them instead of only receiving data from them.
* Forms are introduced by the `<form>` tag and **supported by other tags like:`<fieldset>, <input>, <textarea>, <select> and <option>` and their respective attributes.
1. attributes for `<form>`:
    * **name**: an internal identifier.
    * **action**: defines the location of the response.
    * **method**: refers to HTTP method that is used to send the message. 
        * _POST_: the information is not transmitted via the requested URL
        * _GET_: to append the information sent to server into the URL.

2. `<input>`
    * nest `<input>` tags in `<form>` to allow users input data.
    * _Flavors_ for `<input>`: 
        * **Normal inputs**: collect the data to be sent to the server and come in various forms like: text fields, color selectors, check boxes, data selectors, and sliders.
        * **Hidden inputs**: define data that is sent to the server but user have **no** option to manipulate the input.
        * **Reset input**: simply **reset** all inputs and selections made so for.
        * **submit buttons**: **sending** the supplied data.
    * attributes for `<input>`
        * **name**: unambiguously associates the information with a specific input.
        * **type**: to tell the browser how to gather the information. Define the _flavor_ of `<input>`.
        * **value** (optional): supplies a default value that is sent to the server if no information is supplied by the user.

3. Other tags used for gather data in _forms_:
    * `<textarea>`: gather **multi-line** text.
    * `<select>` nesting with `<option>`: provide selections to user.

4. **query string**: The string that user input into the form. It will append to the URL of the response in a form as "?parameter=value"

## 2.10 The foreign script tag `<script>`
* `<script>`: a *container* of scripts in other languages that can be executed in HTML document.

## 2.11 Table tags `<table>`, `<tr>`, `<td>`, `<th>`
* `<table>`: enclose the **whole area** for table.
* `<tr>`: enclose the **rows** of the table.
* `<td>`: enclose the **cells** of the table.
* `<th>`: enclose the **header** cells

# 4. Parsing
## 4.1. Thins to do before parsing:
    * Inspect through the web page looking for useful information. (Browser is better for display HTML)
    * Import it into R for extracting data.

* **Document Object Model(DOM)** is a queryable data object that bridges the gap between HTML documents and R-specific data structure.

* DOM-style parser Package: **XML** provides an interface to _libxml2_, a powerful parsing library written in C that is able to cope with many parsing-specific problems. 

* `htmlParse(file = URL)`: parse the HTML from URL. What does it perform on the files:
    1. Parses the entire target document and creates the DOM in a tree-like data structure of the _C language_(a node set) with a automatic _validation_ step for malformation.
    2. The C-level node structure is converted into an object of the R language.

## 4.2. Discarding nodes
* **Handler functions**: Translate C-level node to R object. 
* Specifying handlers as a list of **named functions** to organize its behavior.
    * name: corresponds to a node name
    * function: specifies what should happen with the node.
    * Generic handlers for DOM-style parsing

                Function name       |       Node type
        ------------------------- | ----------------------
        `startElement()`          | XML element
        `text()`                  | Text node
        `comment()`               | Comment node
        `cdata()`                 | <CDATA> node
        `processingInstruction()` | Processing instruction
        `namespace()`             | XML namespace
        `entity()`                | Entity reference

1. Definite a list of function: 

```
h1 <- list("node_name" = function(x){NULL})
h2 <- list(
            startElement = function(node, ...){
            name <- xmlName(node)
            if(name %in% c("div", "title")){NULL}else{node}
            },
            comment = function(node){NULL}
)
```

2. Run handler with the list: 

```
parsed_file <- htmlTreeParse(url, handler = h1, as Tree = True)
parsed_file <- htmlTreeParse(url, handler = h2, as Tree = True)
```

## 4.3. Extracting information in the building process
* Specifying the handlers to **route** specific nodes into an R object of our own choosing.
* **Problem**: We need to create a data object containing the information in our current workspace (global environment), but function in R operate on local variables and have **no** writing access to the global environment.
* **Solution**: To define the handler function for the specific nodes in the document as a so-called **closure** (a function that is capable of referencing objects that are not local to it.). The environment is needed to define **container variables** to which we route the handler's output, as well as a return function for the variables' contents.
* An example for get all italic words (with `<i>` tags) in HTML:
    ```
    # Define a function list for <i>
    getItalics = function(){
        i_container <- character() # generate a local container
        list(i = function(node, ...){
            i_container <<- c(i_container, xmlValue(node)) # Append the xml value of (<i>) nodes to container        }, returnI = function() i_container) # return the container just created
    }
    h3 <- getItalics() # execute getItalics() and return values into h3
    invisible(htmlTreeParse(url, handlers = h3)) # pass function to handler and suppress printing of the DOM to the screen
    h3$returnI() * print the content of <i> nodes to the screen.
    ```
* h3 contains handler function, but additionally, the function can access `i_container` and `returnI()` as these two objects were created in the same environment as the handler function.
* "<<- (super assignment operator) allow making an assignment to nonlocal variables.
