# 1. Introduction
* XPath is a **query language** that is useful for **addressing** and **extracting** parts from HTML/XML
documents. It is a **domain-specific** language.
* XPath only works on tha **DOM representation** of a document and cannot be applied on the native code.

# 2. Identifying nodes sets with XPath
## 2.1 Basic structure of an XPath query
* **hierarchical addressing mechanism**: constructing a sequence of nodes separated by the `/`.
* **Absolute path**: start from root node and describe a sequence of consecutive node to the target node.
* **Relative path**: "jump" between nodes, by '//'.
* **Wildcard**: `*` indicate **any single** node.
* selection expression:
    * `..`: select the node **one level up** the hierarchy from the current node.
    * `.`: select the **current node** (or self-axis)
* Multiple path:
    * `|`: `path1 | path2`
    * store the XPath queries in a **vector** and pass it ro `xpathSApply()`

## 2.2 Node relations
* Construction of XPath statement for _node relations_ is: `node1/relation::node2`, where _node2_ has specific _relation_ to _node1_.
* **relations** could be : _ancestor_, _ancestor-or-self_, _attribute_, _descendant_, _descendant-or-self_, _following_, _following-sibling_, _namespace_, _parent_, _preceding_, _preceding-sibling_, _child_, _self_.

## 2.3 XPath predicates
* Predicates are simply **functions** that are applied to node's _name_, _value_, or _attribute_, and evaluate whether a **condition** (or set of conditions) is true or false. And the Nose where the response is **true** are selected.
* using: `node[predicate]`
* [XPath operators](https://www.w3schools.com/xml/xpath_operators.asp)
* [XPath syntax](https://www.w3schools.com/xml/xpath_syntax.asp)

### 2.3.1 Numerical predicates
* Predicates using the **counts** of **positions** of nodes.
* `count(node_set)`: return the count of *node_set*.
* `position()`: return the _position_ of _node_
* `last()`: select last element of a node set.
* `@node`: retrieves the attributes from _node_.
* `text(node)`: return the content of node.
* `string-length(text)`: return the length of the _text_

### 2.3.2 Textual predicates
* regular expression can be used here.
* this book described XPath 1.0, but the w3schools suggests XPath 3.0 now. The functions in this section are not shown on the website. It might because the supporting of Regex.

# 3. Extracting node elements
`xmlName`, `xmlValue`, `xmlGetAttr`, `xmlAttrs`, `xmlChildren`, `xmlSize`

## 3.1 Extending the fun argument
`xpathSapply(doc, path, fun = function)`

The goal of further processing can either lie in cleansing the numeric or textual content of the node, or some kind of exception handling in order to deal with extraction failures.

### 3.1.1 Using variables in XPath expressions
* It is inevitable to treat XPath expression themselves as variable parts of the extraction program.
* `sprintf(string, vector)`: paste _string_ and each elements within _vector_ and return a new vector.

## 3.2 XML namespaces
`xpathSApply(doc, path, namespaces = c(x = URL))`: Using _namespaces_ argument to specify the namespace.

## 3.3 Little XPath helper tools
* [SelectorGadget](https://selectorgadget.com/)
* Web Developer Tools